{"version":3,"sources":["../src/setup_moodle_settings.js"],"names":["define","$","ajax","validator","str","moodleSettings","errorsContainer","loaderContainer","save","callback","validateEmail","val","baseSettingsPromises","call","methodname","args","params","webservice","is","rest_protocol","soap_protocol","user_identifier","enable_tracking","enable_sso_link","email","done","response","fail","stringPromises","get_string","when","localizedEditString","status","data","showErrors","errorsText","html","removeClass","hideErrors","addClass","closeTab","openTab"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * This plugin provides access to Moodle data in form of analytics and reports in real time.\r\n *\r\n *\r\n * @package    local_intelliboard\r\n * @copyright  2020 IntelliBoard, Inc\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n * @website    https://intelliboard.net/\r\n */\r\n\r\ndefine([\r\n    \"jquery\", \"core/ajax\", \"local_intelliboard/validator\", \"core/str\"\r\n], function($, ajax, validator, str) {\r\n    var moodleSettings = {\r\n        errorsContainer: $(\".moodle-settings .warnings-block\"),\r\n        loaderContainer: $(\".moodle-settings .loader\"),\r\n        save: function(callback) {\r\n            if (validator.validateEmail($(\"#subscription_email\").val())) {\r\n                var baseSettingsPromises = ajax.call([\r\n                    {\r\n                        methodname: \"local_intelliboard_setup_base_settings\", args: {\r\n                            params: {\r\n                                webservice: $(\"#webservice\").is(\":checked\"),\r\n                                rest_protocol: $(\"#rest_protocol\").is(\":checked\"),\r\n                                soap_protocol: $(\"#soap_protocol\").is(\":checked\"),\r\n                                user_identifier: $(\"#usernameorid\").val(),\r\n                                enable_tracking: $(\"#enable_tracking\").is(\":checked\"),\r\n                                enable_sso_link: $(\"#enable_sso_link\").is(\":checked\"),\r\n                                email: $(\"#subscription_email\").val()\r\n                            }\r\n                        }\r\n                    },\r\n                ]);\r\n\r\n                baseSettingsPromises[0].done(function(response) {\r\n                    callback(response);\r\n                });\r\n\r\n                baseSettingsPromises[0].fail(function() {\r\n                    var stringPromises = str.get_string('server_error', \"local_intelliboard\");\r\n\r\n                    $.when(stringPromises).done(function(localizedEditString) {\r\n                        callback({status: \"error\", data: '<p>' + localizedEditString + '</p>'});\r\n                    });\r\n                });\r\n            } else {\r\n                var stringPromises = str.get_string('invalid_email', \"local_intelliboard\");\r\n\r\n                $.when(stringPromises).done(function(localizedEditString) {\r\n                    callback({status: \"error\", data: '<p>' + localizedEditString + '</p>'});\r\n                });\r\n            }\r\n        },\r\n\r\n        showErrors: function(errorsText) {\r\n            moodleSettings.errorsContainer.html(errorsText);\r\n            moodleSettings.errorsContainer.removeClass(\"hidden\");\r\n        },\r\n\r\n        hideErrors: function() {\r\n            moodleSettings.errorsContainer.html(\"\");\r\n            moodleSettings.errorsContainer.addClass(\"hidden\");\r\n        },\r\n\r\n        closeTab: function() {\r\n            $(\".moodle-settings\").addClass(\"closed\");\r\n        },\r\n\r\n        openTab: function() {\r\n            $(\".moodle-settings\").removeClass(\"closed\");\r\n        }\r\n    };\r\n\r\n    return moodleSettings;\r\n});"],"file":"setup_moodle_settings.min.js"}