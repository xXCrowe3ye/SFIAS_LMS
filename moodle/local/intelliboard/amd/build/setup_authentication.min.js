define ("local_intelliboard/setup_authentication",["jquery","core/ajax","local_intelliboard/validator","core/str"],function(a,b,c,d){var e={errorsContainer:a(".tab-item.authentication .warnings-block"),loaderContainer:a(".tab-item.authentication .loader"),showErrors:function showErrors(a){e.errorsContainer.html(a);e.errorsContainer.removeClass("hidden")},hideErrors:function hideErrors(){e.errorsContainer.html("");e.errorsContainer.addClass("hidden")},closeTab:function closeTab(){a(".tab-item.authentication").addClass("closed")},openTab:function openTab(){a(".tab-item.authentication").removeClass("closed")},showLoginForm:function showLoginForm(){a(".tab-item .tab-body .login-form").removeClass("hidden")},hideLoginForm:function hideLoginForm(){a(".tab-item .tab-body .login-form").addClass("hidden")},showRegisterForm:function showRegisterForm(){a(".tab-item .tab-body .register-form").removeClass("hidden")},hideRegisterForm:function hideRegisterForm(){a(".tab-item .tab-body .register-form").addClass("hidden")},setFormEmail:function setFormEmail(b){a("#loginEmail").val(b);a("#registerEmail").val(b)},checkEmail:function checkEmail(d,e){if(c.validateEmail(d)){var f=b.call([{methodname:"local_intelliboard_setup_check_email",args:{email:a("#subscription_email").val()}}]);f[0].done(function(a){e(a)});f[0].fail(function(){e({email_exists:!1})})}else{e({email_exists:!1})}},loginHandler:function loginHandler(c,f,g){e.loaderContainer.addClass("hidden");a(".tab-body .login-form .sign-in").unbind("click");a(".tab-body .login-form .sign-in").on("click",function(){var h=a("#loginEmail").val(),i=a("#loginPassword").val();e.loaderContainer.removeClass("hidden");e.hideErrors();if(!h||!i){var j=d.get_string("all_fields_required","local_intelliboard");a.when(j).done(function(a){e.loaderContainer.addClass("hidden");e.showErrors(a)})}else{var k=b.call([{methodname:"local_intelliboard_setup_login",args:{email:h,password:i,moodle_service_token:c,restProtocol:f}}]);k[0].done(function(a){e.loaderContainer.addClass("hidden");if("error"===a.status){e.showErrors(a.message)}else{g()}});k[0].fail(function(){var b=d.get_string("server_error","local_intelliboard");a.when(b).done(function(a){e.loaderContainer.addClass("hidden");e.showErrors("<p>"+a+"</p>")})})}})},registerHandler:function registerHandler(c,f,g){e.loaderContainer.addClass("hidden");a(".tab-body .register-form .sign-up").unbind("click");a(".tab-body .register-form .sign-up").on("click",function(){var h=a("#registerEmail").val(),i=a("#registerPassword").val(),j=a("#registerName").val();e.loaderContainer.removeClass("hidden");e.hideErrors();if(!h||!i||!j){var k=d.get_string("all_fields_required","local_intelliboard");a.when(k).done(function(a){e.loaderContainer.addClass("hidden");e.showErrors(a)})}else{var l=b.call([{methodname:"local_intelliboard_setup_register",args:{name:j,email:h,password:i,country:a("#registerCountry").val(),moodle_service_token:c,restProtocol:f}}]);l[0].done(function(a){e.loaderContainer.addClass("hidden");if("error"===a.status){e.showErrors(a.message)}else{g()}});l[0].fail(function(){var b=d.get_string("server_error","local_intelliboard");a.when(b).done(function(a){e.loaderContainer.addClass("hidden");e.showErrors("<p>"+a+"</p>")})})}})}};return e});
//# sourceMappingURL=setup_authentication.min.js.map
